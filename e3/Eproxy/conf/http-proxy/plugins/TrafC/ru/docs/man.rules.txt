\ Некоторые слова, употребимые в правилах.

\ В скобках указана стековая нотация  ( до_выполнения -- после_выполнения ).
\ Значения, указанные в кавычках, берутся из входного потока (а не из стека).
\ Все имена регистрозависимы. В качестве разделителя использовать пробел.


| ( flag -- ) 
    \ Слово | используется в строках файла правил. 
    \ Часть строки справа от | выполняется, если условие (часть слева от |) истинно.

IP= ( "ip_address" -- flag ) 
    \ flag-истина, если клиент соединился с сервером по указанному IP
    \ i.e.   IP= 10.0.0.1  | ...
Port= ( "port" -- flag ) 
    \ flag-истина, если клиент соединился с сервером по указанному порту
IP:Port= ( "ip_address:port" -- flag ) 
    \ flag-истина, если клиент соединился с сервером по указанному IP и порту
PeerIP:Port= ( "ip_address:port" -- flag ) 
    \ flag-истина, если клиент соединился с указанного IP и порта
PeerIP= ( "ip_address" -- flag ) 
    \ flag-истина, если клиент соединился с указанного IP
PeerPort= ( "port" -- flag ) 
    \ flag-истина, если клиент соединился с сервером с указанного порта
PeerIP:Mask= ( "ip:mask" -- flag ) 
    \ flag-истина, если клиент соединился с сервером с указанного диапазона IP-адресов
CLIENT ( -- addr u ) 
    \ PeerIP NtoA (ip-адрес клиента в виде строки)

=~ ( addr u "mask" -- flag )
    \ сравнение строки, представленой адресом и длиной, с маской.  
    \ i.e.   CLIENT =~ 10.0.0.* | ...
~  ( str "mask" -- flag )
    \ сравнение по маске со строкой, представленой str

User ( -- addr u )
    \ возвращает имя пользователя ( u = 0, если имени нет)

URL ( -- addr u )
    \ возвращает урл. (для acFreeProxy) 

\EOF ( -- )
    \ закончить трансляцию текущего файла (не проверяя остальные правила)
