<html>
<head>
<title>Traffic Control</title>
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1251">
<meta HTTP-EQUIV="keywords" CONTENT="traffic control, TrafC, bandwidth, quota, priority, eserv, proxy, limits, restricting, трафик, ограничение, квоты">
<meta HTTP-EQUIV="description" CONTENT="text/html; charset=windows-1251">
</head>

<body leftmargin=50 marginheight="0" marginwidth="0" bottommargin="10" topmargin="20">

<table border=0 cellspacing=0 cellpadding=0 width=98%> <tr><td>

<H1>
    TrafC 
</H1>
<H2>
    Traffic Control plugin for Eserv/3, Eproxy
</H2>

<br><h2>
    Управление трафиком. Как это работает.
</h2>
<br><h3>
    Характеристики трафика.
</h3>
<p>
    TrafC позволяет управлять следующими характеристиками для 
<strong>
      любой части
</strong>
    проходящего через него трафика:
<h4>
<ul><li>
    приоритет
</li><li>
<em>
    средняя
</em>
      скорость
</li><li>
    суммарный объем (квота)
</li></ul>
</h4>
</p>
<p>
    Это позволяет решить многие задачи, связанные с перегрузкой канала связи
    и нехватки полосы пропускания для важных приложений, контролированием
    общего трафика.
</p>
<p>
    Для управления этими характеристиками используются следующие объекты
</p>
<p>
<table border=1 cellspacing=2 cellpadding=5>
<tr>
<th>
    Объект
</th>
<th>
    Свойство
</th></tr>

<tr>
<td>
    Сеанс (каждое подключение к серверу)
</th>
<td>
    Приоритет обслуживания запросов 
</th>
</tr>

<tr>
<td>
    Bandwidth-каналы
</th>
<td>
    Пропускная способность
</th>
</tr>

<tr>
<td>
    Quota-каналы
</td>
<td>
    Величина допустимого объема трафика
    и период обнуления счетчика
</th>
</tr>
</table>

</p>
<p>
    Bandwidth-каналы и Quota-каналы являются 
<em>
    виртуальными каналами, 
</em>
    которые регулируют соответствующие характеристики трафика, 
    проходящего через них.
</p>
<a name=bandwidth></a>
<br><h3>
    Bandwidth-каналы
</h3>
<p>
    Bandwidth-каналы ограничивают верхнее значение средней скорости.
    Для этих каналов задается пропускная способность в CPS (т.е.,
    столько-то байт в секунду).
</p>
<p>
    Bandwidth-каналы имеют приоритетные очереди, поэтому в них возможно 
    обслуживание запросов в порядке приоритета.
    Это означает, что каждый запрос будет ожидать, пока в очереди есть 
    более приоритетный  запрос.
</p>
<p>
    Приоритетные очереди дают возможность вне конкуренции обслуживать каких-то
    клиентов (например, почтовых агентов, или администратора ;)
</p>

<a name=priority></a>
<br><h3>
    Приоритеты
</h3>
<p>
    Каждому сеансу (каждому подключившемуся клиенту) можно выставить свой приоритет.
    Значения приоритета используется в очередях Bandwidth-каналов. При этом сегменты
    более приоритетного трафика проходят через канал вперед сегментов менее
    приоритетного трафика.
</p>
<p>
    Наибольшему приоритету соответствует численное значение 0.
    И далее, большим численным значениям соответствует меньший приоритет.
    По умолчанию сеанс имеет приоритет численным значением 0.
</p>

<br><h3>
    Гарантии
</h3>
<p>
    Приоритетные очереди вкупе с виртуальными каналами
    позволяют очень гибко распределять имеющийся канал связи (полосу пропускания).
    Они дают возможность гарантировать заданную пропускную способность
    для части трафика, сравнимую с резервированием части физического канала.
</p>
<p>
    При резервировании выделенный канал (или часть канала) не может
    использоваться иначе, чем под целевой трафик, независимо от наличия
    этого трафика. 
    Виртуальные каналы позволяют использовать не востребованную часть
    физического канала под любой другой имеющийся трафик (возможно,
    также с учетом приоритетов).
</p>
<p>
    Использовать наивысший приоритет имеет смысел для постоянного (синхронного)
    трафика, которому нужна неизменная  пропускная способность 
    независимо от пульсаций асинхронного трафика.
</p>

<a name=quota></a>
<br><h3>
    Quota-каналы
</h3>
<p>
    Quota-каналы обеспечивают выполнение
<em>
    квот
</em>
    (норм, допусков, ограничений) на объем проходящего через них трафика.
    Эти каналы подсчитают объем информации. Если период канала не закончился, 
    а его квота исчерпалась, то невозможно передавать через этот канал, 
    пока не закончится период.
</p>
<p>
    Для этих каналов задается квота на объем и период времени.
    Например, 10 Мб в неделю.  
</p>

<br><h3>
    Выделение части трафика
</h3>

<p>
    TrafficControl может для управления выделять часть трафика
    в пространстве и во времени.
</p>
<p>
    Минимальная частью в пространстве является трафик одного сеанса
    ( TCP-соединения или portMAP-соединения).
    Минимальной частью во времени является трафик одного HTTP-запроса
    или одного соединения.
    При этом, размер сегмента дискретизации сравним с размером IP-пакета.
</p>
<p>
    Для выделения некоторой части из общего трафика используются 
<strong>
    правила.
</strong>
    В правила могут входить условия, оперирующие такими данными, как
<ul>
<li>
    IP-адрес сервера
</li><li>
    порт сервера
</li><li>
    IP-адрес клиента (в том числе по маске)
</li><li>
    имя пользователя
</li><li>
    целевой URL или его часть
</li><li>
    и другие...
</li>
</ul>
    Правило может объединять несколько условий логическими операциями
    AND, OR, XOR, NOT.
</p>

<p>
<table border=1 cellspacing=0 cellPadding=10><tr><td>

    На основе правил,  для
<strong>
    каждой выделенной части
</strong>
    трафика
    определяется  приоритет и набор виртуальных каналов,
    через которые будет пропускаться этот трафик.

</td></tr></table>
</p><p>
    Таким образом весь трафик распределяется по виртуальным каналам.
</p><p>
    Динамические характеристики трафика каждого сеанса будут определятся 
    его приоритетом, набором виртуальных каналов, через которые он проходит, а также
    параметрами и загруженностью этих каналов.
</p><p>
    Другими словами, характеристики трафика каждого сеанса будут определятся
    самым тонким местом в наборе каналов - каналом, в котором удельная на
    каждый сеанс пропускная способность (с учетом приоритеов) наименьшая.
</p>


<br><h3>
    Конфигурирование
</h3>
<p>
    Конфигурирование включает в себя
<ol> <li>
    Определение именованных виртуальных каналов и задание их характеристик, в том числе

<ul><li>
    определение quota-каналов
</li><li>
    определение bandwidth-каналов
</li></ul>

</li><li>
    Создание базы правил для распределения трафика по виртуальным каналам.
</li></ol>
</p>
<p>
</p>


<hr>
<small>
(p) 2001-2002 <a href="mailto:rvm(no_spam)@eserv.ru"> Ruvim Pinka </a>
</small>

</th></tr></table> 

</body>
</html>

